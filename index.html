<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Video Library & Reviews (Dynamic v5)</title> <!-- Version Bump -->
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 10px; /* Add some padding for smaller screens */
        }
        .nav-menu {
            background-color: #3498db;
            padding: 10px 0;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            /* Allow wrapping on small screens */
            white-space: normal;
        }
        .nav-item {
            display: inline-block;
            margin: 5px 8px; /* Add vertical margin for wrapping */
        }
        .nav-link {
            color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.2s;
            display: inline-flex; /* Use inline-flex for better alignment */
            align-items: center;
            font-size: 0.95em;
            vertical-align: middle; /* Helps alignment when wrapping */
        }
        .nav-link:hover, .nav-link.active { /* Add active state style */
            text-decoration: none;
            background-color: #2980b9;
        }
        .nav-logo {
            height: 20px;
            width: 20px; /* Ensure consistent width */
            margin-right: 8px;
            vertical-align: middle; /* Explicitly set */
            object-fit: contain; /* Prevent distortion */
        }
        /* Style for non-logo nav items like Reviews */
        .nav-link .icon-placeholder {
             display: inline-block;
             width: 20px; /* Match logo width for alignment */
             height: 20px;
             margin-right: 8px;
             /* Optional: Add a generic icon or leave blank */
             /* background-image: url('path/to/generic-icon.svg'); */
             background-size: contain;
        }
        .project-section, .reviews-section { /* Apply similar styling to reviews */
            background-color: white;
            margin: 0 10px 30px 10px; /* Adjust margin for container padding */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            scroll-margin-top: 80px; /* Adjust based on nav height */
        }
        .section-title { /* Generic title class */
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 0;
            display: flex;
            align-items: center;
        }
         .project-logo {
            height: 28px;
            width: 28px; /* Ensure consistent width */
            margin-right: 12px;
            object-fit: contain; /* Prevent distortion */
         }
        .video-list {
            list-style-type: none;
            padding: 0;
            margin-top: 20px;
        }
        .video-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .video-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .video-link {
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            word-break: break-all; /* Prevent long URLs from breaking layout */
        }
        .video-link:hover {
            text-decoration: underline;
        }
        .video-date {
            color: #7f8c8d;
            font-size: 0.9em;
            display: block;
        }
        /* Reviews Section Specifics */
        .reviews-content {
            margin-top: 20px;
        }
        .reviews-content p {
            margin-bottom: 15px;
        }
        .reviews-content a {
            color: #3498db;
            font-weight: bold;
        }
         .reviews-content a:hover {
             text-decoration: underline;
         }

        /* Target Highlight */
        :target {
             animation: highlight 1.5s ease-out;
        }
        @keyframes highlight {
            0% { background-color: #fff3cd; }
            100% { background-color: white; } /* Use white for final state */
        }
        .no-videos, .error-message {
            color: #7f8c8d;
            font-style: italic;
            margin-top: 15px;
            text-align: center;
            padding: 20px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }
        .error-message {
             color: #dc3545;
             background-color: #f8d7da;
             border-color: #f5c6cb;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .nav-menu {
                padding: 10px 5px; /* Reduce padding */
            }
            .nav-item {
                margin: 5px; /* Adjust margin */
            }
            .nav-link {
                font-size: 0.9em;
                padding: 6px 10px;
            }
            .project-section, .reviews-section {
                margin-left: 5px;
                margin-right: 5px;
            }
        }
         @media (max-width: 480px) {
            .nav-link {
                font-size: 0.85em;
                padding: 5px 8px;
            }
             .nav-logo, .nav-link .icon-placeholder {
                 height: 18px;
                 width: 18px;
                 margin-right: 5px;
             }
             .project-logo {
                 height: 24px;
                 width: 24px;
                 margin-right: 8px;
             }
             .section-title {
                 font-size: 1.3em;
             }
        }

    </style>
</head>
<body>
    <div class="container" id="app-container">
        <!-- Content will be generated here -->
         <div id="initial-message" class="error-message" style="display: none;">Loading or processing error occurred. Check console.</div>
    </div>

    <script>
        // --- Data Configuration ---

        // Cleaned Raw data + NEW additions + explicit additions from user
        const rawData = `Titan X Volt Genie Turbo Bonfire Ascendant Shaolin Phoenix Goat X Vyper Tinc Awesome X shogun Eden Inferno Flux Lotus Alien X https://x.com/stevedefi7/status/1889978808838828365 https://x.com/DEFIVOLT/status/1865378239079649491 http://x.com/GenieofBitcoin/status/1890736245250064660 https://x.com/DEFIVOLT/status/1865128507677765818/video/1 https://x.com/bonfirex28/status/1885069997258461387 https://x.com/TraderLi/status/1881740630025474449 https://x.com/ShaolinXDeFi/status/1877867235378639304 https://x.com/TeamPhoenixWin/status/1878096271761641753 https://x.com/Irishcrypto4/status/1873346605354799139 https://x.com/DEFIVOLT/status/1869759697689162153/video/1 https://x.com/DEFIVOLT/status/1869509928043548971 https://x.com/AwesomeXwins/status/1864842043559723287 https://x.com/OGXenian/status/1859342345394679902 https://x.com/InfernoBullWin/status/1855551435343069270 https://x.com/BADSPORTSLABS/status/1853163226110021985 https://x.com/BADSPORTSLABS/status/1846520759633559589 https://x.com/stevedefi7/status/1889770327376306610 https://x.com/DEFIVOLT/status/1853399116228768245 http://x.com/GenieofBitcoin/status/1885505019304124734 https://x.com/DEFIVOLT/status/1863393551939199303/video/1 https://x.com/TraderLi/status/1879831091701272824 https://x.com/TeamPhoenixWin/status/1873396664658194456 https://x.com/DEFIVOLT/status/1869090140397945097/video/1 https://x.com/DEFIVOLT/status/1865890554078171602 https://x.com/AwesomeXwins/status/1862267075307172298 https://x.com/InfernoBullWin/status/1854261152399958172 https://x.com/BADSPORTSLABS/status/1853090359053533220 https://x.com/stevedefi7/status/1888191305182060674 https://x.com/DEFIVOLT/status/1852687396749390260 http://x.com/DEFIVOLT/status/1877149638182023492/video/1 https://x.com/WarriorSoul8888/status/1876627463972741404 https://x.com/TeamPhoenixWin/status/1867968160827404796 https://x.com/DEFIVOLT/status/1870133827726872688/video/1 https://x.com/AwesomeXwins/status/1859703586663563350 https://x.com/BADSPORTSLABS/status/1848809794725167207 https://x.com/BADSPORTSLABS/status/1847610579785064782 https://x.com/stevedefi7/status/1886165345020543364 https://x.com/DEFIVOLT/status/1852565486971617651 http://x.com/DEFIVOLT/status/1877149638182023492 https://x.com/TeamPhoenixWin/status/1867189629570486312 https://x.com/DEFIVOLT/status/1870470517645595127 https://x.com/CryptoAwesomely/status/1857419025019465895 https://x.com/stevedefi7/status/1885467132932104363 https://x.com/TeamPhoenixWin/status/1865792356856766902 https://x.com/DEFIVOLT/status/1869179511725867299 https://x.com/AwesomeXwins/status/1856376901067055337 https://x.com/DEFIVOLT/status/1868939350068936767/video/1 https://x.com/TeamPhoenixWin/status/1864006412067574096 https://x.com/DEFIVOLT/status/1868813133550436771/video/1 https://x.com/AwesomeXwins/status/1854613794485682570 https://x.com/DEFIVOLT/status/1868824186082541913/video/1 https://x.com/YoungStunnersss/status/1852235153260609873 https://x.com/DEFIVOLT/status/1862844964893274459/video/1 https://x.com/BADSPORTSLABS/status/1863199228421349382 https://x.com/DEFIVOLT/status/1869393318658093424 https://x.com/CryptoAwesomely/status/1852001203879575688 https://x.com/DEFIVOLT/status/1866093137896288697/video/1 https://x.com/TeamPhoenixWin/status/1861870732533174487 https://x.com/DEFIVOLT/status/1868939350068936767 https://x.com/CryptoAwesomely/status/1851665703331598668 https://x.com/DEFIVOLT/status/1865890554078171602/video/1 https://x.com/TeamPhoenixWin/status/1861090584191983879 https://x.com/DEFIVOLT/status/1868813133550436771 https://x.com/AwesomeXwins/status/1851264070948962634 https://x.com/DEFIVOLT/status/1865378239079649491/video/1 https://x.com/DEFIVOLT/status/1866140933617508723 https://x.com/HQMORPH/status/1873415806358548644 https://x.com/YoungStunnersss/status/1851232501941109210 https://x.com/DEFIVOLT/status/1862276723829539197 https://x.com/DEFIVOLT/status/1861414044961325469 https://x.com/stevedefi7/status/1865149383269839168 https://x.com/DEFIVOLT/status/1861103389481779627 https://x.com/DEFIVOLT/status/1850989795675115927 https://x.com/DEFIVOLT/status/1860987425092178274 https://x.com/DEFIVOLT/status/1849937867969073605 https://x.com/DEFIVOLT/status/1848650254016446748 https://x.com/DEFIVOLT/status/1858702568777548275 https://x.com/DEFIVOLT/status/1849957575028044287 https://x.com/DEFIVOLT/status/1848301692921463101 https://x.com/DEFIVOLT/status/1858447132304331000 https://x.com/DEFIVOLT/status/1849821229504422162 https://x.com/DEFIVOLT/status/1848040441750372464 https://x.com/DEFIVOLT/status/1858181200059269543 https://x.com/DEFIVOLT/status/1848460017189507245 https://x.com/DEFIVOLT/status/1847980852476604604 https://x.com/DEFIVOLT/status/1857765776972824864 https://x.com/BADSPORTSLABS/status/1849393982603710694 https://x.com/DEFIVOLT/status/1847363848723960002 https://x.com/DEFIVOLT/status/1857569622603468979 https://x.com/BADSPORTSLABS/status/1848103583515824397 https://x.com/DEFIVOLT/status/1847103855361757539 https://x.com/DEFIVOLT/status/1857178548878094363 https://x.com/DEFIVOLT/status/1846270583602139249 https://x.com/DEFIVOLT/status/1846230744709915079 https://x.com/DEFIVOLT/status/1856343968021115330 https://x.com/DEFIVOLT/status/1846813821966413863 https://x.com/DEFIVOLT/status/1856039292541260060 https://x.com/DEFIVOLT/status/1846664074421293221 https://x.com/DEFIVOLT/status/1855771819984437451 https://x.com/DEFIVOLT/status/1846496479722033225 https://x.com/DEFIVOLT/status/1855171571532333411 https://x.com/DEFIVOLT/status/1846194177131811167 https://x.com/DEFIVOLT/status/1855084888686252085 https://x.com/DEFIVOLT/status/1846061235516682315 https://x.com/DEFIVOLT/status/1855064563747553517 https://x.com/DEFIVOLT/status/1845822158448058397 https://x.com/DEFIVOLT/status/1854854751353024930 https://x.com/DEFIVOLT/status/1845744072742273072 https://x.com/DEFIVOLT/status/1854083901196476695 https://x.com/DEFIVOLT/status/1845560752637428209 https://x.com/DEFIVOLT/status/1853776598257783290 https://x.com/DEFIVOLT/status/1845167790728056856 https://x.com/DEFIVOLT/status/1853450369076023372 https://x.com/DEFIVOLT/status/1845006487430611184 https://x.com/DEFIVOLT/status/1853261442767520119 https://x.com/DEFIVOLT/status/1844981709734818192 https://x.com/DEFIVOLT/status/1852998319263387707 https://x.com/DEFIVOLT/status/1844844495336300629 https://x.com/DEFIVOLT/status/1854348777898864759 https://x.com/DEFIVOLT/status/1844677949305299350 https://x.com/DEFIVOLT/status/1845935713931395555 https://x.com/DEFIVOLT/status/1844528000450089306 https://x.com/stevedefi7/status/1844396816521117854 https://x.com/DEFIVOLT/status/1844403728922837322 https://x.com/DEFIVOLT/status/1844154514762498188 https://x.com/DEFIVOLT/status/1844175794844860650 https://x.com/DEFIVOLT/status/1843868927061045605 https://x.com/DEFIVOLT/status/1843695828822536213 https://x.com/DEFIVOLT/status/1843610181059670280 https://x.com/DEFIVOLT/status/1843544290951299360 https://x.com/DEFIVOLT/status/1843466027377561996 https://x.com/DEFIVOLT/status/1843314563867202046 https://x.com/DEFIVOLT/status/1843196464266137848 https://x.com/DEFIVOLT/status/1843235972726882685 https://x.com/DEFIVOLT/status/1843001360243195914 https://x.com/DEFIVOLT/status/1843108643878899993 https://x.com/DEFIVOLT/status/1843091541998674206 https://x.com/DEFIVOLT/status/1842870492610314526 https://x.com/DEFIVOLT/status/1842857786729771345 https://x.com/DEFIVOLT/status/1841802047605129351 https://x.com/DEFIVOLT/status/1841741551002587149 https://x.com/DEFIVOLT/status/1841585703953592327 https://x.com/DEFIVOLT/status/1841287005403070970 https://x.com/DEFIVOLT/status/1841134035709350117 https://x.com/HQMORPH/status/1904162009702191458 https://x.com/HQMORPH/status/1903837091186032689 https://x.com/HQMORPH/status/1903459911184314581 https://x.com/HQMORPH/status/1903458941717069836 https://x.com/HQMORPH/status/1904198770952146963 https://x.com/stevedefi7/status/1906054263089905838 https://x.com/Irishcrypto4/status/1865356837182124441 https://x.com/Irishcrypto4/status/1863695272238252494 https://x.com/HQMORPH/status/1904168293465829428 https://x.com/PumpUranus/status/1912142027862450643 https://x.com/HQMORPH/status/1888275111574208928`;

        // Fallback mapping
        const handleToProjectFallback = {
            'stevedefi7': 'Titan X',
            'DEFIVOLT': 'Volt', // Primarily Volt, but URLs are explicitly assigned elsewhere too
            'GenieofBitcoin': 'Bitcoin Genie',
            'bonfirex28': 'Bonfire',
            'TraderLi': 'Ascendant',
            'ShaolinXDeFi': 'Shaolin', // Used for Shaolin, Eden, Lotus - explicit assignments needed
            'TeamPhoenixWin': 'Phoenix',
            'Irishcrypto4': 'Goat X',
            'AwesomeXwins': 'AwesomeX',
            'OGXenian': 'Shogun',
            'InfernoBullWin': 'Inferno',
            'BADSPORTSLABS': 'Flux', // Used for Flux, Alien X, Titan X, Inferno - explicit assignments needed
            'WarriorSoul8888': 'Ascendant',
            'HQMORPH': 'Morpheus', // Used for Morpheus, Switch, Bonfire, Titan X - explicit assignments needed
            'PumpUranus': 'Smoke',
            'CryptoAwesomely': 'AwesomeX',
            'inkayknows': 'Alien X', // Added handle for Alien X
            'smoothncrypto': 'Flare', // Added handle for Flare
            'flare_win': 'Flare'     // Added handle for Flare
        };

        // *** LOGO CONFIGURATION ***
        // IMPORTANT: Create an 'images' folder and place these files inside it!
        const projectLogos = {
           'Eden': 'images/eden.png',
           'Shogun': 'images/shogun.png',
           'Morpheus': 'images/morpheus.png',
           'Phoenix': 'images/phoenix.png',
           'Vyper': 'images/vyper.png',
           'Inferno': 'images/inferno.png',
           'Lotus': 'images/lotus.png',
           'Titan X': 'images/titan-x.png',
           'Bitcoin Genie': 'images/bitcoin-genie.png',
           'Titan Blaze': 'images/titan-blaze.png',
           'AwesomeX': 'images/awesomex.png',
           'Flux': 'images/flux.png',
           'Smoke': 'images/smoke.png',
           'Goat X': 'images/goat-x.png',
           'Shaolin': 'images/shaolin.png',
           'Bonfire': 'images/bonfire.png',
           'Alien X': 'images/alien-x.png',
           'Flare': 'images/flare.png',          // **NEW** Add flare.png to images folder
           'Volt': 'images/volt.png',
           'Dragon X': 'images/dragon-x.png',
           'Switch': 'images/switch.png',

           // Placeholders for projects without provided logos
           'Turbo': 'https://via.placeholder.com/30/FF5733/FFFFFF?text=T',
           'Ascendant': 'https://via.placeholder.com/30/33FF57/FFFFFF?text=A',
           'Tinc': 'https://via.placeholder.com/30/3357FF/FFFFFF?text=Ti'
        };
        const defaultLogo = 'https://via.placeholder.com/30/cccccc/FFFFFF?text=?'; // Fallback if logo is missing

        // --- Helper Functions (Keep as they are) ---
         function normalizeUrl(url) {
            if (!url || typeof url !== 'string') return null;
            url = url.trim();

            // Remove query parameters first (like ?s=...&t=...)
             const urlParts = url.split('?');
             url = urlParts[0];

            url = url.replace(/\/+$/, ''); // Remove trailing slashes AFTER removing query params

            // Normalize variations of x.com URLs
             url = url.replace(/^http:\/\/(www\.)?x\.com/, 'https://x.com');
             url = url.replace(/^https:\/\/(www\.)?x\.com/, 'https://x.com');
             url = url.replace(/^http:\/\/(www\.)?twitter\.com/, 'https://x.com');
             url = url.replace(/^https:\/\/(www\.)?twitter\.com/, 'https://x.com');

            // Remove /video/1 suffix specifically
            url = url.replace(/\/video\/1$/, '');

            if (!url.startsWith('https://x.com/') || !url.includes('/status/')) {
                 // console.warn(`Invalid URL format after normalization: ${url}`); // Reduce noise
                 return null;
            }

             try {
                 const urlObj = new URL(url);
                 const pathSegments = urlObj.pathname.split('/');
                 if (pathSegments.length < 4 || pathSegments[2] !== 'status' || !/^\d+$/.test(pathSegments[3])) {
                    // console.warn(`URL Path segments invalid for status URL: ${urlObj.pathname}`); // Reduce noise
                    return null;
                 }
                 return urlObj.origin + urlObj.pathname;
             } catch (e) {
                 console.error(`Error parsing URL ${url}`, e);
                 return null;
             }
        }

        function extractStatusId(url) {
            // ... (keep function as is) ...
             if (!url) return null;
             try {
                 const urlObj = new URL(url);
                 const pathSegments = urlObj.pathname.split('/');
                 if (pathSegments.length > 3 && /^\d+$/.test(pathSegments[3])) {
                     return BigInt(pathSegments[3]);
                 }
             } catch (e) { console.error(`Error extracting status ID from ${url}`, e); }
             return null;
        }

        function getHandle(url) {
             // ... (keep function as is) ...
              if (!url) return null;
              try {
                 const urlObj = new URL(url);
                 const pathSegments = urlObj.pathname.split('/');
                  // Handle should be the 2nd segment (index 1)
                 if (pathSegments.length > 1 && pathSegments[1]) {
                     return pathSegments[1];
                 }
             } catch (e) { console.error(`Error extracting handle from ${url}`, e); }
             return null;
        }

        function getApproxDateFromStatusId(statusId) {
            // ... (keep function as is) ...
             if (!statusId) return null;
             const twitterEpoch = 1288834974657n;
             try {
                 const timestampMs = Number(statusId >> 22n) + Number(twitterEpoch);
                 return new Date(timestampMs);
             } catch (e) {
                 console.error("Error calculating date from status ID:", statusId, e);
                 return null;
             }
        }

        function formatDisplayDate(date) {
            // ... (keep function as is) ...
             if (!date || isNaN(date.getTime())) {
                 return "Date unavailable";
             }
             return date.toLocaleDateString('en-US', {
                 year: 'numeric', month: 'long', day: 'numeric'
             });
        }

        function slugify(text) {
          // ... (keep function as is) ...
           if (!text) return '';
           return text.toString().toLowerCase()
             .replace(/\s+/g, '-')
             .replace(/[^\w\-]+/g, '')
             .replace(/\-\-+/g, '-')
             .replace(/^-+/, '')
             .replace(/-+$/, '');
        }

         // --- Main Processing Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const appContainer = document.getElementById('app-container');
            const initialMessageDiv = document.getElementById('initial-message');
            if (!appContainer || !initialMessageDiv) {
                console.error("Critical HTML elements not found!");
                if(initialMessageDiv) initialMessageDiv.style.display = 'block';
                return;
            }

            try {
                 const finalProjectNameMapping = {}; // Keep if needed for renaming later
                 function getFinalProjectName(name) {
                     return finalProjectNameMapping[name] || name;
                 }

                // 1. Define Explicit Assignments + Initialize ALL known projects from logos
                const explicitAssignments = {};
                 // Initialize ALL projects listed in projectLogos to ensure they are created
                 Object.keys(projectLogos).forEach(projName => {
                     explicitAssignments[projName] = new Set();
                 });

                 // --- ADD EXPLICIT URLS HERE (OVERWRITES FALLBACKS) ---
                 Object.assign(explicitAssignments, {
                     'AwesomeX': new Set([
                         normalizeUrl('https://x.com/CryptoAwesomely/status/1851665703331598668'), normalizeUrl('https://x.com/CryptoAwesomely/status/1852001203879575688'), normalizeUrl('https://x.com/CryptoAwesomely/status/1857419025019465895')
                     ]),
                     'Titan X': new Set([
                         normalizeUrl('https://x.com/BADSPORTSLABS/status/1849393982603710694'), normalizeUrl('https://x.com/HQMORPH/status/1873415806358548644'), normalizeUrl('https://x.com/DEFIVOLT/status/1868824186082541913'), normalizeUrl('https://x.com/DEFIVOLT/status/1850989795675115927'),
                     ]),
                     'Inferno': new Set([
                         normalizeUrl('https://x.com/BADSPORTSLABS/status/1848809794725167207'),
                         normalizeUrl('https://x.com/InfernoBullWin/status/1855551435343069270'), // Add from raw data if needed
                         normalizeUrl('https://x.com/InfernoBullWin/status/1854261152399958172')  // Add from raw data if needed
                      ]),
                     'Bitcoin Genie': new Set([
                          normalizeUrl('https://x.com/stevedefi7/status/1906054263089905838'), normalizeUrl('https://x.com/DEFIVOLT/status/1877149638182023492'),
                          normalizeUrl('http://x.com/GenieofBitcoin/status/1890736245250064660'), // Add from raw data
                          normalizeUrl('http://x.com/GenieofBitcoin/status/1885505019304124734') // Add from raw data
                     ]),
                     'Goat X': new Set([
                         normalizeUrl('https://x.com/Irishcrypto4/status/1865356837182124441'), normalizeUrl('https://x.com/Irishcrypto4/status/1863695272238252494'),
                         normalizeUrl('https://x.com/Irishcrypto4/status/1873346605354799139') // Add from raw data
                     ]),
                     'Bonfire': new Set([
                         normalizeUrl('https://x.com/HQMORPH/status/1904168293465829428'),
                         normalizeUrl('https://x.com/bonfirex28/status/1885069997258461387') // Add from raw data
                      ]),
                     'Volt': new Set([
                         normalizeUrl('https://x.com/stevedefi7/status/1844396816521117854'), normalizeUrl('https://x.com/DEFIVOLT/status/1865890554078171602'), normalizeUrl('https://x.com/DEFIVOLT/status/1865378239079649491'),
                         normalizeUrl('https://x.com/YoungStunnersss/status/1852235153260609873'), normalizeUrl('https://x.com/YoungStunnersss/status/1851232501941109210')
                         // Many more DEFIVOLT links could be added here if they are specifically Volt
                     ]),
                     'Ascendant': new Set([
                         normalizeUrl('https://x.com/WarriorSoul8888/status/1876627463972741404'),
                         normalizeUrl('https://x.com/TraderLi/status/1881740630025474449'), // Add from raw data
                         normalizeUrl('https://x.com/TraderLi/status/1879831091701272824') // Add from raw data
                      ]),
                     'Vyper': new Set([ // Most DEFIVOLT links seem to be Vyper based on original code
                         'https://x.com/DEFIVOLT/status/1870470517645595127', 'https://x.com/DEFIVOLT/status/1869759697689162153', 'https://x.com/DEFIVOLT/status/1869393318658093424',
                         'https://x.com/DEFIVOLT/status/1869509928043548971', 'https://x.com/DEFIVOLT/status/1869090140397945097', 'https://x.com/DEFIVOLT/status/1868939350068936767',
                         'https://x.com/DEFIVOLT/status/1868813133550436771', 'https://x.com/DEFIVOLT/status/1866140933617508723', 'https://x.com/DEFIVOLT/status/1862276723829539197',
                         'https://x.com/DEFIVOLT/status/1861414044961325469', 'https://x.com/DEFIVOLT/status/1861103389481779627', 'https://x.com/DEFIVOLT/status/1860987425092178274',
                         'https://x.com/DEFIVOLT/status/1858702568777548275', 'https://x.com/DEFIVOLT/status/1858447132304331000', 'https://x.com/DEFIVOLT/status/1858181200059269543',
                         'https://x.com/DEFIVOLT/status/1857765776972824864', 'https://x.com/DEFIVOLT/status/1857569622603468979', 'https://x.com/DEFIVOLT/status/1857178548878094363',
                         'https://x.com/DEFIVOLT/status/1856343968021115330', 'https://x.com/DEFIVOLT/status/1856039292541260060', 'https://x.com/DEFIVOLT/status/1855771819984437451',
                         'https://x.com/DEFIVOLT/status/1855171571532333411', 'https://x.com/DEFIVOLT/status/1855084888686252085', 'https://x.com/DEFIVOLT/status/1855064563747553517',
                         'https://x.com/DEFIVOLT/status/1854854751353024930', 'https://x.com/DEFIVOLT/status/1854348777898864759', 'https://x.com/DEFIVOLT/status/1854083901196476695',
                         'https://x.com/DEFIVOLT/status/1853776598257783290', 'https://x.com/DEFIVOLT/status/1853450369076023372', 'https://x.com/DEFIVOLT/status/1853399116228768245',
                         'https://x.com/DEFIVOLT/status/1852565486971617651'
                         // Add many more DEFIVOLT URLs from raw data that fit Vyper
                     ].map(normalizeUrl).filter(Boolean)),
                     'Turbo': new Set([
                         normalizeUrl('https://x.com/DEFIVOLT/status/1865128507677765818'), normalizeUrl('https://x.com/DEFIVOLT/status/1863393551939199303'),
                         // normalizeUrl('https://x.com/DEFIVOLT/status/1863178170590994871'), // Check if this belongs
                         normalizeUrl('https://x.com/DEFIVOLT/status/1862844964893274459')
                     ]),
                     'Switch': new Set([
                         normalizeUrl('https://x.com/HQMORPH/status/1904162009702191458'), normalizeUrl('https://x.com/HQMORPH/status/1903837091186032689')
                     ]),
                     'Morpheus': new Set([
                         normalizeUrl('https://x.com/HQMORPH/status/1903459911184314581'), normalizeUrl('https://x.com/HQMORPH/status/1903458941717069836'),
                         normalizeUrl('https://x.com/HQMORPH/status/1904198770952146963'),
                         normalizeUrl('https://x.com/HQMORPH/status/1888275111574208928')
                     ]),
                     'Smoke': new Set([
                         normalizeUrl('https://x.com/PumpUranus/status/1912142027862450643')
                     ]),
                     'Shaolin': new Set([
                         normalizeUrl('https://x.com/ShaolinXDeFi/status/1877867235378639304'), // Add from raw data
                         normalizeUrl('https://x.com/ShaolinXDeFi/status/1877498519625322802'), // Add from raw data
                         // Some ShaolinXDeFi links are assigned to Lotus/Eden below
                     ]),
                     'Phoenix': new Set([
                         normalizeUrl('https://x.com/TeamPhoenixWin/status/1878096271761641753'), // Add from raw data
                         normalizeUrl('https://x.com/TeamPhoenixWin/status/1873396664658194456'), // Add from raw data
                         // Add more TeamPhoenixWin links here
                     ]),
                      'Flux': new Set([
                          normalizeUrl('https://x.com/BADSPORTSLABS/status/1853163226110021985'), // Add from raw data
                          normalizeUrl('https://x.com/BADSPORTSLABS/status/1853090359053533220'), // Add from raw data
                          // Add more BADSPORTSLABS links that are Flux
                      ]),
                       'Shogun': new Set([
                           normalizeUrl('https://x.com/OGXenian/status/1859342345394679902') // Add from raw data
                       ]),

                     // --- NEW EXPLICIT ASSIGNMENTS ---
                     'Lotus': new Set([
                         normalizeUrl('https://x.com/shaolinxdefi/status/1848117529308225576'),
                         normalizeUrl('https://x.com/shaolinxdefi/status/1847807818616672748'),
                         normalizeUrl('https://x.com/shaolinxdefi/status/1847063085925675089'),
                         normalizeUrl('https://x.com/shaolinxdefi/status/1845944249616936997')
                     ]),
                     'Eden': new Set([
                         normalizeUrl('https://x.com/shaolinxdefi/status/1857075293296505026'),
                         normalizeUrl('https://x.com/shaolinxdefi/status/1857436863784435885')
                     ]),
                     'Alien X': new Set([
                         normalizeUrl('https://x.com/inkayknows/status/1847011292755738650'),
                         normalizeUrl('https://x.com/badsportslabs/status/1846832234059227557'),
                         normalizeUrl('https://x.com/badsportslabs/status/1846520759633559589')
                     ]),
                     'Flare': new Set([ // New Project
                         normalizeUrl('https://x.com/smoothncrypto/status/1874213135550472483'),
                         normalizeUrl('https://x.com/flare_win/status/1903124690467475954')
                     ])
                 }); // End of Object.assign


                // Keep track of all URLs assigned explicitly
                const assignedUrls = new Set();
                Object.values(explicitAssignments).forEach(urlSet => {
                    if (urlSet) {
                       urlSet.forEach(url => { if(url) assignedUrls.add(url); });
                    }
                });

                // 2. Process Raw Data - Add only URLs NOT explicitly assigned, using fallbacks
                const urls = rawData.split(/\s+/);
                const potentialUrls = urls.filter(u => u.startsWith('http') || u.startsWith('x.com') || u.startsWith('twitter.com'));

                potentialUrls.forEach(rawUrl => {
                    const normalized = normalizeUrl(rawUrl);
                    if (normalized && !assignedUrls.has(normalized)) {
                        const handle = getHandle(normalized);
                        const fallbackProjectName = handle ? handleToProjectFallback[handle] : null;
                        const projectName = fallbackProjectName ? getFinalProjectName(fallbackProjectName) : null;

                        if (projectName) {
                             if (explicitAssignments.hasOwnProperty(projectName)) {
                                if (!explicitAssignments[projectName]) {
                                    explicitAssignments[projectName] = new Set();
                                }
                                // Only add via fallback if not already added explicitly
                                explicitAssignments[projectName].add(normalized);
                                assignedUrls.add(normalized);
                            } else {
                                console.warn(`Fallback project "${projectName}" (handle: ${handle}, URL: ${normalized}) not in initialized projects (projectLogos/explicitAssignments). URL ignored.`);
                            }
                        } else if (handle) {
                             // console.warn(`No project mapping found for handle "${handle}" (URL: ${normalized}). URL ignored.`); // Reduce noise
                        } else {
                             // console.warn(`Could not extract handle for unassigned URL: ${normalized}. URL ignored.`); // Reduce noise
                        }
                    }
                });

                // 3. Finalize Projects Data Structure & Remove Empty Projects
                const projects = {};
                let totalValidVideos = 0;
                for (const projectName in explicitAssignments) {
                    if (!projectLogos.hasOwnProperty(projectName) && !['Ascendant', 'Tinc', 'Turbo'].includes(projectName) /*Allow placeholders*/) { // Ensure we only process projects with logos or placeholders
                       // console.log(`Skipping project "${projectName}" as it's not in projectLogos or allowed placeholders.`);
                       continue;
                    }

                    const urlSet = explicitAssignments[projectName];
                    if (!urlSet || urlSet.size === 0) continue;

                    const validUrls = [...urlSet].filter(url => url !== null);
                    if (validUrls.length === 0) continue;

                     if (!projects[projectName]) projects[projectName] = [];

                    validUrls.forEach(url => {
                        const statusId = extractStatusId(url);
                        if (statusId) {
                            if (!projects[projectName].some(existing => existing.url === url)) {
                                projects[projectName].push({
                                    url: url,
                                    statusId: statusId,
                                    date: getApproxDateFromStatusId(statusId)
                                });
                                totalValidVideos++;
                            }
                        } else {
                           console.warn(`Could not extract Status ID for URL: ${url} in project ${projectName}`);
                        }
                    });
                    if (projects[projectName].length === 0) {
                         delete projects[projectName];
                    }
                }

                // --- Check if any projects/videos were actually found ---
                if (Object.keys(projects).length === 0 || totalValidVideos === 0) {
                     console.error("No valid projects with videos found after processing data.");
                     appContainer.innerHTML = '<div class="error-message">No valid project data found to display. Check data source and assignments.</div>';
                     return;
                 }

                // 4. Sort Project Names Alphabetically
                const sortedProjectNames = Object.keys(projects).sort((a, b) => a.localeCompare(b));

                // --- Start Rendering ---
                appContainer.innerHTML = ''; // Clear initial message

                // 5. Generate Navigation Menu (including Reviews)
                try {
                    const navMenu = document.createElement('div');
                    navMenu.className = 'nav-menu';

                    // Add Project links
                    sortedProjectNames.forEach(projectName => {
                        const projectSlug = slugify(projectName);
                        if (!projectSlug) return; // Skip if slug is empty

                        const navItem = document.createElement('div'); navItem.className = 'nav-item';
                        const navLink = document.createElement('a'); navLink.className = 'nav-link'; navLink.href = `#${projectSlug}`;
                        const logoImg = document.createElement('img'); logoImg.className = 'nav-logo';
                        logoImg.src = projectLogos[projectName] || defaultLogo; logoImg.alt = `${projectName} Logo`;
                        logoImg.onerror = function() { this.src = defaultLogo; this.alt = 'Default Logo'; };
                        navLink.appendChild(logoImg);
                        navLink.appendChild(document.createTextNode(projectName));
                        navItem.appendChild(navLink); navMenu.appendChild(navItem);
                    });

                    // Add Reviews link
                    const reviewsNavItem = document.createElement('div'); reviewsNavItem.className = 'nav-item';
                    const reviewsNavLink = document.createElement('a'); reviewsNavLink.className = 'nav-link'; reviewsNavLink.href = '#reviews-section'; // Link to the new section ID
                    // Optional: Add a placeholder or generic icon for visual consistency
                    const iconPlaceholder = document.createElement('span'); iconPlaceholder.className = 'icon-placeholder';
                    // Example: reviewsNavLink.appendChild(iconPlaceholder);
                    reviewsNavLink.appendChild(document.createTextNode('Reviews'));
                    reviewsNavItem.appendChild(reviewsNavLink); navMenu.appendChild(reviewsNavItem);


                    appContainer.appendChild(navMenu);
                } catch (navError) {
                    console.error("Error generating navigation menu:", navError); appContainer.innerHTML = '<div class="error-message">Error building navigation. Check console.</div>'; return;
                }

                // 6. Generate Project Sections
                try {
                    sortedProjectNames.forEach(projectName => {
                        const videos = projects[projectName] || [];
                        videos.sort((a, b) => (b.date?.getTime() || 0) - (a.date?.getTime() || 0)); // Safer sort

                        const projectSlug = slugify(projectName);
                        if (!projectSlug) return; // Skip if slug is empty

                        const projectSection = document.createElement('div'); projectSection.className = 'project-section'; projectSection.id = projectSlug;
                        const title = document.createElement('h2'); title.className = 'section-title'; // Use generic class
                        const titleLogoImg = document.createElement('img'); titleLogoImg.className = 'project-logo'; titleLogoImg.src = projectLogos[projectName] || defaultLogo; titleLogoImg.alt = '';
                        titleLogoImg.onerror = function() { this.style.display='none'; };
                        title.appendChild(titleLogoImg); title.appendChild(document.createTextNode(projectName)); projectSection.appendChild(title);

                        if (videos.length > 0) {
                            const videoList = document.createElement('ul'); videoList.className = 'video-list';
                            videos.forEach(video => {
                                const item = document.createElement('li'); item.className = 'video-item';
                                const link = document.createElement('a'); link.className = 'video-link'; link.href = video.url; link.textContent = `View Post on X`; link.target = '_blank'; link.rel = 'noopener noreferrer';
                                const dateSpan = document.createElement('span'); dateSpan.className = 'video-date'; dateSpan.textContent = `Posted: ${formatDisplayDate(video.date)}`;
                                item.appendChild(link); item.appendChild(dateSpan); videoList.appendChild(item);
                            });
                            projectSection.appendChild(videoList);
                        } else {
                            const noVideosMsg = document.createElement('p'); noVideosMsg.className = 'no-videos'; noVideosMsg.textContent = 'No videos found for this project.'; projectSection.appendChild(noVideosMsg);
                        }
                        appContainer.appendChild(projectSection);
                    });
                } catch (sectionError) {
                     console.error("Error generating project sections:", sectionError); const errorDiv = document.createElement('div'); errorDiv.className = 'error-message project-section'; errorDiv.textContent = 'Error building project sections. Check console.'; appContainer.appendChild(errorDiv);
                }

                // 7. Generate Reviews Section
                try {
                    const reviewsSection = document.createElement('div');
                    reviewsSection.className = 'reviews-section'; // Use new class
                    reviewsSection.id = 'reviews-section'; // Add ID for linking

                    const reviewsTitle = document.createElement('h2');
                    reviewsTitle.className = 'section-title';
                    reviewsTitle.textContent = 'Community Reviews & Feedback';
                    reviewsSection.appendChild(reviewsTitle);

                    const reviewsContent = document.createElement('div');
                    reviewsContent.className = 'reviews-content';
                    reviewsContent.innerHTML = `
                        <p>See what others are saying or share your own experiences with these projects!</p>
                        <p>We value your feedback. You can discuss these projects and share your reviews on X (formerly Twitter).</p>
                        <p>
                            <!-- Example: Link to a general discussion or a specific account -->
                            <a href="https://x.com/YourCommunityHandle" target="_blank" rel="noopener noreferrer">Join the conversation on X!</a>
                            <!-- Or add other relevant links -->
                        </p>
                        <p><em>More review features coming soon...</em></p>
                    `; // Customize this HTML content as needed
                    reviewsSection.appendChild(reviewsContent);

                    appContainer.appendChild(reviewsSection); // Append after project sections

                } catch (reviewsError) {
                    console.error("Error generating reviews section:", reviewsError);
                    const errorDiv = document.createElement('div'); errorDiv.className = 'error-message project-section'; errorDiv.textContent = 'Error building reviews section. Check console.'; appContainer.appendChild(errorDiv);
                }


            } catch (mainError) {
                 console.error("Major error during script execution:", mainError); appContainer.innerHTML = '<div class="error-message">A major error occurred processing the data. Check console.</div>';
            }
        });

    </script>
</body>
</html>
